<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="http://chris-lesage.github.io/theme/stylesheet/styles.css">

  <link rel="stylesheet" type="text/css" href="http://chris-lesage.github.io/theme/pygments/github.min.css">
  

    <link href="http://chris-lesage.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Rigmarole Blog Atom">


    <link rel="shortcut icon" href="/theme/img/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/theme/img/favicon.ico" type="image/x-icon">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />


<meta name="author" content="Chris Lesage" />
<meta name="description" content="Here is a tutorial that will demonstrate how to use a Unit Vector to animate the pivot point of a cylinder so that the cylinder will roll on its bottom edge in any direction. I’m using this technique for the feet of my Mini Mammoth rig, but it could also be useful for robot feet, or adapted into different shapes for a variety of uses. Here is a video of the foot rolling effect we are going to create ..." />
<meta name="keywords" content="rigging, maya, rigtip, math">
<meta property="og:site_name" content="Rigmarole Blog"/>
<meta property="og:title" content="Using a Unit Vector to Make a Cylindrical Foot Roll"/>
<meta property="og:description" content="Here is a tutorial that will demonstrate how to use a Unit Vector to animate the pivot point of a cylinder so that the cylinder will roll on its bottom edge in any direction. I’m using this technique for the feet of my Mini Mammoth rig, but it could also be useful for robot feet, or adapted into different shapes for a variety of uses. Here is a video of the foot rolling effect we are going to create ..."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="http://chris-lesage.github.io/character-rigging/using-a-unit-vector-to-make-a-cylindrical-foot-roll/"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2012-04-03 02:42:00-04:00"/>
<meta property="article:modified_time" content="2012-04-03 02:42:00-04:00"/>
<meta property="article:author" content="http://chris-lesage.github.io/pages/about/">
<meta property="article:section" content="character-rigging"/>
<meta property="article:tag" content="rigging"/>
<meta property="article:tag" content="maya"/>
<meta property="article:tag" content="rigtip"/>
<meta property="article:tag" content="math"/>
<meta property="og:image" content="">
  <title>Rigmarole Blog &ndash; Using a Unit Vector to Make a Cylindrical Foot Roll</title>
</head>
<body>
  <aside>
    <div>
      <a href="http://chris-lesage.github.io">
        <img src="http://chris-lesage.github.io/theme/img/logo_header.png" alt="" title=""><br>
        <img src="http://chris-lesage.github.io/theme/img/logo_text.png" alt="" title="">
      </a>
      <h1><a href="http://chris-lesage.github.io"></a></h1>
      <p></p>
      <nav>
        <ul class="list">
          <li><a href="/blog/">Blog</a></li>
              <li><a href="http://chris-lesage.github.io/pages/tech-artist-demoreel/">demoreel</a></li>
              <li><a href="http://chris-lesage.github.io/pages/about/">about</a></li>
              <li><a href="http://chris-lesage.github.io/pages/tools/">tools</a></li>
              <li><a href="http://chris-lesage.github.io/pages/now/">now</a></li>
        </ul>
      </nav>
      <ul class="social">
      </ul>
    </div>
  </aside>
  <main>

<article>
  <header>
    <div class="article_title">
    <img src ='gears_64'>
    <h2><a href="http://chris-lesage.github.io/character-rigging/using-a-unit-vector-to-make-a-cylindrical-foot-roll/">Using a Unit Vector to Make a Cylindrical Foot&nbsp;Roll</a></h2>
    <p>Posted on 2012-04-03 - category: <a href="http://chris-lesage.github.io/category/character-rigging/">character-rigging</a></p>
    </div>
  </header>

    <p>Here is a tutorial that will demonstrate how to use a Unit Vector to animate the pivot point of a cylinder so that the cylinder will roll on its bottom edge in any direction. I&#8217;m using this technique for the feet of my <a href="http://chrislesage.com/series/making-of-mini-mammoth/">Mini Mammoth rig</a>, but it could also be useful for robot feet, or adapted into different shapes for a variety of&nbsp;uses.</p>
<p>Here is a video of the foot rolling effect we are going to&nbsp;create:</p>
<iframe width="560" height="315" src="http://www.youtube.com/embed/aSecO4KFjNw" frameborder="0" allowfullscreen></iframe>

<p><strong>Note: Be aware that my expression syntax may or may not play nicely with Wordpress, depending on how you are viewing this post. I have included a Maya 2012 scene file at the bottom of this post so you can download it and follow along. The final expression is included as a text&nbsp;file.</strong></p>
<p><strong>Notes about this&nbsp;tutorial:</strong></p>
<ul>
<li>I am using locators as vectors so we can see what is going on. Once we are done prototyping this as an expression we can transform it into node connections that work directly with the attribute data rather than a daisy-chain of connected locators. This tutorial will just show the expression so you can get the&nbsp;idea.</li>
<li>The order of the lines in your expression matters. Specifically, the foot&#8217;s rotation attributes will have to be animated before the pivots are translated in the expression. Otherwise I&#8217;ve found that you will sometimes get strange results. If your animation seems to jump or skip, keep this in&nbsp;mind.</li>
<li>For simplicity, the way I build this ignores rotation in Y. Instead when I go to integrate this into a real rig, I&#8217;ll group this entire foot roll rig underneath a parent node and use that to rotate in Y in global&nbsp;space.</li>
<li>The next step you could take would be to project the vector onto a curve using a closestPoint constraint. Shape the curve to match your character&#8217;s foot, and now you can have a foot roll in any shape you&nbsp;want!</li>
</ul>
<h3>So let&#8217;s get&nbsp;started</h3>
<ol>
<li>Create a cylinder with a radius of 5 and move it up so that it rests at the ground&nbsp;plane.</li>
<li>Create a joint at the bottom of the cylinder. Group the joint and call the group &#8220;foot_pivot&#8221;. The group will be controlled by the expression. Skin the cylinder to the&nbsp;joint.</li>
<li>Create a &#8220;foot_roll&#8221; controller. This can be a locator or a curve icon or whatever. This is the controller that will rotate the foot.
<img alt="&lt;img src=" src="http://chrislesage.com/wp-content/uploads/2012/04/cylinder_roll_step1-3.jpg" /></li>
<li>Create two locators. Name the first one &#8220;vector1&#8221; and the second one&nbsp;&#8220;normalized_vector1&#8221;.</li>
<li>Select the &#8220;foot_pivot&#8221; group. Go into Edit -&gt; Channel Control and in the Nonkeyable Hidden column make the following visible and keyable:
<pre>
Rotate Pivot X, Rotate Pivot Y, Rotate Pivot Z
Rotate Pivot Translate X, Rotate Pivot Translate Y, Rotate Pivot Translate Z
</pre>
<img alt="&lt;img src=" src="http://chrislesage.com/wp-content/uploads/2012/03/cylinder_roll_step5.jpg" /></li>
<li>The first step is to turn the rotation of the &#8220;foot_roll&#8221; control into <span class="caps">XZ</span> translation which we will feed into the pivot point of &#8220;foot_pivot&#8221;.
<pre>
vector1.translateX = -foot_pivot.rotateZ;
vector1.translateZ = foot_pivot.rotateX;
// (note the negative value. This may change for you depending
// on your controllers orientation.)
</pre>
<img alt="&lt;img src=" src="http://chrislesage.com/wp-content/uploads/2012/03/anim_vector.gif" />
When you rotate the &#8220;foot_roll&#8221; now &#8220;vector1&#8221; will travel along the ground plane pointing in the direction of the rotation. But the distance from the foot is wrong and it is not in a circular shape.&nbsp;So&#8230;</li>
<li>We arrive at the meat of this entire tutorial. To get a useful pivot we need to create a <strong>Unit Vector</strong> or a normalized vector which will always have the same length of 1 no matter which direction it is pointing.<br><br>If you aren&#8217;t familiar with vectors, this would be the same as having a 1-bone <span class="caps">IK</span> chain. As you move the effector around, the chain points in the correct direction, but stays the same length.<br><br>However, if you aren&#8217;t familiar with vectors, I highly suggest learning about them. They will open up a new world of ideas for you as a rigger or <span class="caps">TD</span>.
<a href="http://www.rtrowbridge.com/blog/2012/03/442/">http://www.rtrowbridge.com/blog/2012/03/442/</a>
<img alt="&lt;img src=" src="http://chrislesage.com/wp-content/uploads/2012/03/unit_vectors_ahoy.jpg" />
<br>We&#8217;ll use the built-in unit() vector function in the Expression Editor. Later if you want to rebuild it with nodes, you can get the same functionality with the vectorProduct node and turning &#8220;Normalize output&#8221; to <span class="caps">ON</span>.
<pre>
vector $norm = unit(&lt;<vector1.translateX,vector1.translateY,vector1.translateZ>&gt;);
</pre></li>
<li>Now we have a vector, so let&#8217;s drive the &#8220;normalized_vector&#8221; locator so we can see what it is doing. (We don&#8217;t need to use the Y-component.)
<pre>
normalized_vector1.translateX = $norm.x
normalized_vector1.translateZ = $norm.z
</pre></li>
<li>Ok, but now the problem is that our foot radius is 5 units and the Unit Vector is only 1 unit long. So let&#8217;s create a variable to multiply the unit vector which will be easy to edit if we need to use it on different sized cylinders. We add the following to the expression:
<pre>
float $radius = 5.0;
normalized_vector1.translateX = $norm.x * $radius;
normalized_vector1.translateZ = $norm.z * $radius;
</pre>
Now the &#8220;normalized_vector1&#8221; should be travelling in a circle around our foot as we rotate&nbsp;&#8220;foot_roll&#8221;.</li>
<li>Now this normalized vector is just for visualization or debugging purposes. Let&#8217;s connect that straight into the rotatePivotX and rotatePivotZ attributes of the &#8220;foot_pivot&#8221;. (the group that parents the foot joint.)
<pre>
foot_pivot.rotatePivotX = $norm.x * $radius;
foot_pivot.rotatePivotZ = $norm.z * $radius;
</pre></li>
<li>And finally, rotate the &#8220;foot_pivot&#8221;. (Note that this will go at the top of the expression. Putting it at the bottom caused erratic behaviour for me.)
<pre>
foot_pivot.rotateX = foot_roll.rotateX;
foot_pivot.rotateY = 0;
foot_pivot.rotateZ = foot_roll.rotateZ;
</pre></li>
</ol>
<h3>Bring it all together and this is our final&nbsp;expression:</h3>
<pre>
// Rotate the pivot_rotator to match the controller
foot_pivot.rotateX = foot_roll.rotateX;
foot_pivot.rotateY = 0;
foot_pivot.rotateZ = foot_roll.rotateZ;
float $radius = 5.0;
// Turn the controller rotation into XZ translation
vector1.translateX = -foot_pivot.rotateZ;
vector1.translateZ = foot_pivot.rotateX;
// Normalize the vector
vector $norm = unit(<<vector1.translateX,vector1.translateY,vector1.translateZ>>);
// Use the normalized coordinates to set the position of norm_vector
normalized_vector1.translateX = $norm.x * $radius;
normalized_vector1.translateZ = $norm.z * $radius;
// Animate the pivot_rotator pivot point to match the normalized vector
foot_pivot.rotatePivotX = $norm.x * $radius;
foot_pivot.rotatePivotZ = $norm.z * $radius;
</pre>

<p><em>(This step is optional or could be done differently.)</em> - Another thing I like to do is connect the &#8220;foot_roll&#8221; translation to the &#8220;foot_pivot.rotatePivotTranslate&#8221;. Then you can translate the &#8220;foot_roll&#8221; to create sliding effects in parent space. So even though the foot roll will be rotated, moving forward in Z will slide the foot along the ground all with one control&nbsp;object.</p>
<blockquote>
<p>**Update: <a href="http://www.robotsquids.blogspot.ca/2013/09/sliding-pivot-foot-roll-tutorial.html">Armin Halac of Robot Squids has created a video tutorial</a> showing how you can build a set up like this that lets use you an arbitrary foot shape using only Maya nodes. Make sure to <a href="http://www.robotsquids.blogspot.ca/2013/09/sliding-pivot-foot-roll-tutorial.html" title="Maya foot roll tutorial">check out his foot roll tutorial here</a>.</p>
</blockquote>
<p><strong> Here is a scene file you can download (Maya&nbsp;2012)</strong></p>
<p>If you&#8217;d like to see the finished expression in action. The expression is included as a text file. <a href="http://chrislesage.com/wp-content/uploads/2012/03/cylinder_roll_example_scene.zip"><strong>Download the finished, animated scene.</strong></a> Let me know in the comments if you found this helpful or if I can explain anything more clearly. Thanks for&nbsp;reading.</p>
<hr />
<h2>Comments</h2>
<p><strong><a href="#28" title="2012-04-03 07:15:45">Ehsan <span class="caps">HM</span></a>:</strong> Very creative Chris, Thanks for&nbsp;sharing!</p>
<p><strong><a href="#78" title="2013-09-19 16:35:35">Chris Lesage</a>:</strong> Update: Armin Halac of Robot Squids has created a great video tutorial showing how you can set this up using Maya nodes, and with any arbitary foot shape:&nbsp;http://www.robotsquids.blogspot.ca/2013/09/sliding-pivot-foot-roll-tutorial.html</p>
  
  <div class="tag-cloud">
    <p>
      <a href="http://chris-lesage.github.io/tag/rigging.html">rigging</a>
      <a href="http://chris-lesage.github.io/tag/maya.html">maya</a>
      <a href="http://chris-lesage.github.io/tag/rigtip.html">rigtip</a>
      <a href="http://chris-lesage.github.io/tag/math.html">math</a>
    </p>
  </div>
</article>

    <footer>
        <nav>
          <a href="http://chris-lesage.github.io">Home</a>
          <a href="http://chris-lesage.github.io/archives.html">Archives</a>
          <a href="http://chris-lesage.github.io/categories.html">Categories</a>
          <a href="http://chris-lesage.github.io/feeds/all.atom.xml">Atom</a>
        </nav>

      <p>&copy; 2016 Chris Lesage - Rigmarole Blog&#12288;&mdash;&#12288;<a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a></p>

    </footer>
  </main>





<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "name": "Using a Unit Vector to Make a Cylindrical Foot Roll",
  "headline": "Using a Unit Vector to Make a Cylindrical Foot Roll",
  "datePublished": "2012-04-03 02:42:00-04:00",
  "dateModified": "2012-04-03 02:42:00-04:00",
  "author": {
    "@type": "Person",
    "name": "Chris Lesage",
    "url": "http://chris-lesage.github.io/pages/about/"
  },
  "image": "{{ SITEURL }}/{{ THEME_STATIC_DIR }}/img/profile.png",
  "url": "http://chris-lesage.github.io/character-rigging/using-a-unit-vector-to-make-a-cylindrical-foot-roll/",
  "description": "Here is a tutorial that will demonstrate how to use a Unit Vector to animate the pivot point of a cylinder so that the cylinder will roll on its bottom edge in any direction. I’m using this technique for the feet of my Mini Mammoth rig, but it could also be useful for robot feet, or adapted into different shapes for a variety of uses. Here is a video of the foot rolling effect we are going to create ..."
}
</script></body>
</html>